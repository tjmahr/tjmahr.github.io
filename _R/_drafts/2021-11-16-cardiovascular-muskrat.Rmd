---
title: Draft post (2021-11-16)
excerpt: ''
tags: ''
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  echo = TRUE
)
```

Here is our input example. It's very basic, meant to illustrate some
function calls, strings, numbers, code comments and output.

```{r, comment = "", echo = FALSE}
writeLines(readLines(solarizeddocx::file_code_block()))
```

We knit the document to run the code and store results in a markdown file:

```{r}
md_file <- knitr::knit(
  solarizeddocx::file_code_block(), 
  output = tempfile(fileext = ".md"),
  quiet = TRUE
)
```

It looks this:

```{r, comment = "", echo = FALSE}
writeLines(readLines(md_file))
```


First, let's set up a workflow for quickly converting a .md file to html
and taking a screenshot of the HTML file. `run_pandoc()` is a wrapper
over `rmarkdown::pandoc_convert()` but hard-codes some output options
and lets us more easily forward options from the `...` to pandoc
`options`. `page_thumbnail()` is a wrapper over `webshot::webshot()`
with some predefined output options.

```{r}
run_pandoc <- function(input, ...) {
  output <- tempfile(fileext = ".html")
  rmarkdown::pandoc_convert(
    input, 
    to = "html5", 
    output = output,
    options = c(
      "--standalone", 
      ...
    )
  )
  output
}

page_thumbnail <- function(url, file, ...) {
  webshot::webshot(
    url = url,  
    file = file,
    vwidth = 500, 
    vheight = 350,
    zoom = 2
  )
}

pd_style <- function(x) c("--highlight-style", x)
pd_syntax <- function(x) c("--syntax-definition", x)
```

Thus, this is the default syntax highlighting in pandoc

```{r}
results <- run_pandoc(md_file, pd_style("tango"))
page_thumbnail(results, "shot1.png")
```


Here is the output but using my solarized (light) theme:

```{r}
theme_sl <- solarizeddocx::file_solarized_light_theme()
results <- run_pandoc(md_file, pd_style(theme_sl))
page_thumbnail(results, "shot2.png")
```

By convention, we see two kinds of comment lines: actual code comments
(`#`) and R output (`#>`). The `#>` comments helpful because I can copy
a whole code block (output included) and run it in R without the output
being interpreted as code. **But these comments represent two different
kinds of information**, and I'd like them to be styled different. The `#`
comments can stay unintrusive (light, italicized), but the `#>` comments
should be legible (darker, upright). 

I modified the R syntax definition used by pandoc to recognized `#` and
`#>` as different things, and we can pass that syntax definition to
pandoc:

```{r}
syntax_sl <- solarizeddocx::file_syntax_definition()
results <- run_pandoc(
  md_file, 
  pd_style(theme_sl), 
  pd_syntax(syntax_sl)
)
page_thumbnail(results, "shot3.png")
```

Maybe you're thinking, *that's cool... if you like solarized. What about something fun like fairyfloss?* Yeah, okay, let's make Fairy Floss.

## Fairy floss





I would say think of the difference between `<code>` and `<samp>` but I have never seen `<samp>` used before.


```{r, include = FALSE}
.parent_doc <- knitr::current_input()
```
```{r, change_to_child_when_done = "_footer.Rmd"}
```
